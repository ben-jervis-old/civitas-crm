<% provide(:title, @roster.title) %>

<div class="page-header">
  <h1>Roster: <%= @roster.title %> </h1>
</div>
<div class="narrow-container">


<div class="row padded-row">
	<h4>
		<%= @roster.description %>
	</h4>
  <p>
      From <strong><%= @formatted_start_date %></strong> to <strong><%= @formatted_end_date %></strong>.
  </p>
</div>
<div class="row padded-row">
	<h4>
		Tasks <%= link_to 'Add new', '#NewTask', class: 'pull-right small' %>
	</h4>
	<div class="panel panel-default">
		<table class="table">
			<% if @roster.tasks.count > 0 %>
				<% @roster.tasks.each do |tsk| %>
					<tr>
				  	<td><%= link_to tsk.title, '#' %></td>
						<td><%= link_to tsk.user.name, tsk.user %></td>
						<td>Due: <%= tsk.due.strftime("%d/%m/%Y") %></td>
					</tr>
			  <% end %>
			<% else %>
				<td>There are no tasks for this roster yet. <%= link_to 'Add one.', '#NewTask' %></td>
			<% end %>
		</table>
	</div>
</div>

<div class="row padded-row">
	<h4>Member List</h4>
	<div class="panel panel-default">
		<table class="table">
			<% if @roster.users.uniq.count > 0 %>
				<% @roster.users.uniq.each do |usr| %>
					<tr>
				  	<td><%= link_to usr.name, usr %></td>
						<td><%= "#{pluralize(@roster.tasks.select{ |tsk| tsk.user_id = usr.id }.count, 'task')} in this roster" %></td>
					</tr>
			  <% end %>
			<% else %>
				<td>There are no users assigned to this roster yet. <%= link_to 'Add one.', '#NewTask' %></td>
			<% end %>
		</table>
	</div>
</div>
</div>
